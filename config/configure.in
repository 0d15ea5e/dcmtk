dnl Process this file with autoconf to produce a configure script.
AC_INIT(Makefile.in)

dnl Configuration Utilities

dnl Get configuration directory
if test -d config ; then
	configdir=config
	dcmtkdir=.
elif test -d ../config ; then
	configdir=../config
	dcmtkdir=..
else
	echo "Cannot find configure directory (config or ../config)"
	exit 1
fi


AC_CONFIG_HEADER($configdir/include/config.h)
AC_CONFIG_AUX_DIR($configdir)
AC_PREFIX_DEFAULT(/usr/local/dicom)

dnl Checks for programs.
AC_PROG_MAKE_SET
AC_PROG_CC
AC_PROG_CPP
AC_CHECK_PROGS(CXX, $CCC c++ cc++ g++ gcc CC cxx, gcc)

case "$CXX" in
c++|g++|gcc) CXXFLAGS='-g -O -Wall -pedantic' ;;
cc++) CXXFLAGS='-g -O -Wall' ;;
CC) CXXFLAGS='+w -g -O' ;;
esac
AC_SUBST(CXXFLAGS)

AC_PROG_CXXCPP
AC_PROG_RANLIB
AC_PROG_INSTALL
AC_CHECK_PROGS(AR, libtool ar)

case "$AR" in
libtool) ARFLAGS=-o ;;
ar) ARFLAGS=-cruv ;;
esac

AC_SUBST(ARFLAGS)

dnl Check special systems
AC_AIX
AC_ISC_POSIX
AC_SYS_LONG_FILE_NAMES

dnl Checks for libraries.
AC_LANG_CPLUSPLUS
AC_CHECK_GXXLIB
AC_CHECK_LIB(iostream, main)


dnl Checks for header files.
AC_HEADER_STDC
AC_CHECK_HEADERS(unistd.h)

dnl Checks for typedefs, structures, and compiler characteristics.
AC_C_INLINE
AC_TYPE_SIZE_T
AC_CHECK_SIZEOF(long)

dnl Checks for library functions.
AC_FUNC_MEMCMP
AC_FUNC_VPRINTF
AC_CHECK_FUNCS(gethostid)
AC_CHECK_FUNCS(sysinfo)
AC_CHECK_FUNCS(strtoul)
AC_CHECK_FUNCS(strchr)
AC_CHECK_FUNCS(itoa)

export configdir
AC_SUBST(configdir)
AC_SUBST(dcmtkdir)
common_makefile=Makefile.def
AC_SUBST(common_makefile)

files=`find . -name "*.in" -print | grep -v "/config" | sed -e 's/.in$/ /g'`
files="$configdir/Makefile.def $configdir/Makefile $files"

AC_OUTPUT($files)











