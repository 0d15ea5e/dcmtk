# declare project
PROJECT(doxygen)

# doxygen support
IF(DOXYGEN_EXECUTABLE)
  ADD_CUSTOM_TARGET(html ${DOXYGEN_EXECUTABLE} htmldocs.tmp)
  SET(DOXYGEN_TARGETS html)
  IF(NOT WIN32) # For unix systems, also build manpages
    ADD_CUSTOM_TARGET(man COMMAND ${DOXYGEN_EXECUTABLE} manpages.tmp
                      COMMAND rm -f ${CMAKE_CURRENT_BINARY_DIR}/manpages/man1/*.man.1
                      COMMAND ${CMAKE_CURRENT_SOURCE_DIR}/patchman.sh WORKING_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR})
    SET(DOXYGEN_TARGETS ${DOXYGEN_TARGETS} man)
  ENDIF(NOT WIN32)

  ADD_CUSTOM_TARGET(DOXYGEN DEPENDS ${DOXYGEN_TARGETS})
ENDIF(DOXYGEN_EXECUTABLE)

# create configuration files (expand variables)
SET(DCMTK_VERSION "${DCMTK_PACKAGE_VERSION}${PACKAGE_VERSION_SUFFIX}")
SET(DOXYGEN_INPUT_DIR "${CMAKE_SOURCE_DIR}")
SET(DOXYGEN_TMPL_DIR "${CMAKE_CURRENT_SOURCE_DIR}")
CONFIGURE_FILE(htmldocs.cfg htmldocs.tmp ESCAPE_QUOTES @ONLY)
IF(NOT WIN32)
  CONFIGURE_FILE(manpages.cfg manpages.tmp ESCAPE_QUOTES @ONLY)
ENDIF(NOT WIN32)

# declare directories to be installed
FILE(MAKE_DIRECTORY htmldocs)
IF(NOT WIN32)
  FILE(MAKE_DIRECTORY man)
ENDIF(NOT WIN32)

# install html docs and manpages
INSTALL(DIRECTORY htmldocs/ DESTINATION ${CMAKE_INSTALL_PREFIX}${INSTALL_HTMDIR} PATTERN "CVS" EXCLUDE)
IF(NOT WIN32)
  INSTALL(DIRECTORY manpages/ DESTINATION ${CMAKE_INSTALL_PREFIX}${INSTALL_MANDIR} PATTERN "CVS" EXCLUDE)
ENDIF(NOT WIN32)
