# declare project
PROJECT(doxygen)

# doxygen support
IF(DOXYGEN_EXECUTABLE)

IF(NOT WIN32) # For unix systems, also build manpages
  ADD_CUSTOM_TARGET(DOXYGEN ${DOXYGEN_EXECUTABLE} htmldocs.tmp WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}
                    COMMAND ${DOXYGEN_EXECUTABLE} manpages.tmp WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}
                    COMMAND cd ${DCMTK_SOURCE_DIR}/doxygen
                    COMMAND rm -f manpages/man1/*.man.1
                    COMMAND ./patchman.sh)
ELSE(NOT WIN32)  # For windows, only html documentation is built
  ADD_CUSTOM_TARGET(DOXYGEN ${DOXYGEN_EXECUTABLE} htmldocs.tmp WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR})
ENDIF(NOT WIN32)

ENDIF(DOXYGEN_EXECUTABLE)

# create configuration files (expand variables)
SET(DCMTK_VERSION "${DCMTK_PACKAGE_VERSION}${PACKAGE_VERSION_SUFFIX}")
CONFIGURE_FILE(${CMAKE_CURRENT_SOURCE_DIR}/htmldocs.cfg ${CMAKE_CURRENT_SOURCE_DIR}/htmldocs.tmp ESCAPE_QUOTES @ONLY)
IF(NOT WIN32)
CONFIGURE_FILE(${CMAKE_CURRENT_SOURCE_DIR}/manpages.cfg ${CMAKE_CURRENT_SOURCE_DIR}/manpages.tmp ESCAPE_QUOTES @ONLY)
ENDIF(NOT WIN32)

# declare directories to be installed
FILE(MAKE_DIRECTORY htmldocs)
IF(NOT WIN32)
FILE(MAKE_DIRECTORY man)
ENDIF(NOT WIN32)

# install html docs and manpages
INSTALL(DIRECTORY htmldocs/ DESTINATION ${CMAKE_INSTALL_PREFIX}/${INSTALL_HTMDIR} PATTERN "CVS" EXCLUDE)
IF(NOT WIN32)
INSTALL(DIRECTORY manpages/ DESTINATION ${CMAKE_INSTALL_PREFIX}/${INSTALL_MANDIR} PATTERN "CVS" EXCLUDE)
ENDIF(NOT WIN32)